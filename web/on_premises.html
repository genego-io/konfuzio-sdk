

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta content="Documentation on how to deploy Konfuzio on premises using Kubernetes and Helm." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>On-Premises Documentation &mdash; Konfuzio  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/full_green_square.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Changelog" href="changelog_app.html" />
    <link rel="prev" title="Konfuzio API Video Tutorial" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Konfuzio
          

          
            
            <img src="../_static/docs__static_square_transparent_super_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v.0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">SDK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sdk/configuration_reference.html">Install SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk/examples/examples.html">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk/sourcecode.html">Source Code Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk/coordinates_system.html">Coordinates System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk/changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html">LabelSectionModel Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#documentmodel-examples">DocumentModel Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#design-philosophy">Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#tokenizers">Tokenizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#vocabularies">Vocabularies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#text-modules">Text Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#image-modules">Image Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#loading-pre-trained-modules">Loading Pre-trained Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#extraction">Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/training_documentation.html#ocr">OCR</a></li>
</ul>
<p class="caption"><span class="caption-text">Web Server</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">Konfuzio API Video Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#konfuzio-train-ai-tutorial">Konfuzio Train AI Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#how-to-make-an-api-call">How to make an API Call</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#document-segmentation-api">Document Segmentation API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#supported-file-types">Supported file types</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">On-Premises Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#required-tools">Required tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kubectl">kubectl</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helm">Helm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-helm">Getting Helm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initializing-helm">Initializing Helm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deployment">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selecting-configuration-options">Selecting configuration options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#secrets">Secrets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#networking-and-dns">Networking and DNS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#persistence">Persistence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tls-certificates">TLS certificates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis">Redis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#persistent-volume">Persistent Volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="#outgoing-email">Outgoing email</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cpu-gpu-and-ram-resource-requirements">CPU, GPU and RAM Resource Requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-using-helm">Deploy using Helm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monitoring-the-deployment">Monitoring the Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initial-login">Initial login</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#upgrade">Upgrade</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#steps">Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#alternative-deployment-options">Alternative deployment options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-vm-setup">Single VM setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-ai-model-training-via-ci-pipelines">Custom AI model training via CI pipelines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog_app.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Konfuzio</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>On-Premises Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="on-premises-documentation">
<h1>On-Premises Documentation<a class="headerlink" href="#on-premises-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="required-tools">
<h2>Required tools<a class="headerlink" href="#required-tools" title="Permalink to this headline">¶</a></h2>
<p>Before deploying Konfuzio to your Kubernetes cluster, there are some tools you must have installed locally.</p>
<div class="section" id="kubectl">
<h3>kubectl<a class="headerlink" href="#kubectl" title="Permalink to this headline">¶</a></h3>
<p>kubectl is the tool that talks to the Kubernetes API.kubectl 1.15 or higher is required and it needs to be compatible
with your cluster (<a class="reference external" href="https://kubernetes.io/docs/tasks/tools/#before-you-begin">+/-1 minor release from your cluster</a>).</p>
<p><a class="reference external" href="https://kubernetes.io/docs/tasks/tools/#install-kubectl">&gt; Install kubectl locally by following the Kubernetes documentation</a>.</p>
<p>The server version of kubectl cannot be obtained until we connect to a cluster. Proceed
with setting up Helm.</p>
</div>
<div class="section" id="helm">
<h3>Helm<a class="headerlink" href="#helm" title="Permalink to this headline">¶</a></h3>
<p>Helm is the package manager for Kubernetes. Konfuzio is tested and supported with Helm v3.</p>
<div class="section" id="getting-helm">
<h4>Getting Helm<a class="headerlink" href="#getting-helm" title="Permalink to this headline">¶</a></h4>
<p>You can get Helm from the project’s <a class="reference external" href="https://github.com/helm/helm/releases">releases page</a>, or follow other options
under the official documentation of <a class="reference external" href="https://helm.sh/docs/intro/install/">installing Helm</a>.</p>
<div class="section" id="connect-to-a-local-minikube-cluster">
<h5>Connect to a local Minikube cluster<a class="headerlink" href="#connect-to-a-local-minikube-cluster" title="Permalink to this headline">¶</a></h5>
<p>For test purposes you can use <code class="docutils literal notranslate"><span class="pre">minikube</span></code> as your local cluster. If <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">cluster-info</span></code>
is not showing <code class="docutils literal notranslate"><span class="pre">minikube</span></code> as the current cluster, use <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">config</span> <span class="pre">set-cluster</span>
<span class="pre">minikube</span></code> to set the active cluster. For clusters in production please visit the <a class="reference external" href="https://kubernetes.io/docs/setup/production-environment/">Kubernetes
Documentation</a>.</p>
</div>
</div>
<div class="section" id="initializing-helm">
<h4>Initializing Helm<a class="headerlink" href="#initializing-helm" title="Permalink to this headline">¶</a></h4>
<p>If Helm v3 is being used, there no longer is an <code class="docutils literal notranslate"><span class="pre">init</span></code> sub command and the command is
ready to be used once it is installed. Otherwise please upgrade Helm.</p>
</div>
</div>
<div class="section" id="next-steps">
<h3>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h3>
<p>Once kubectl and Helm are configured, you can continue to configuring your Kubernetes
cluster.</p>
</div>
</div>
<div class="section" id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h2>
<p>Before running <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">install</span></code>, you need to make some decisions about how you will run
Konfuzio. Options can be specified using Helm’s <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">option.name=value</span></code> command
line option. A complete list of command line options can be found <a class="reference external" href="https://helm.sh/docs/helm/">here</a>. This guide will
cover required values and common options.</p>
<div class="section" id="selecting-configuration-options">
<h3>Selecting configuration options<a class="headerlink" href="#selecting-configuration-options" title="Permalink to this headline">¶</a></h3>
<p>In each section collect the options that will be combined to use with <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">install</span></code>.</p>
<div class="section" id="secrets">
<h4>Secrets<a class="headerlink" href="#secrets" title="Permalink to this headline">¶</a></h4>
<p>There are some secrets that need to be created (e.g. SSH keys). By default they will be
generated automatically.</p>
</div>
<div class="section" id="networking-and-dns">
<h4>Networking and DNS<a class="headerlink" href="#networking-and-dns" title="Permalink to this headline">¶</a></h4>
<p>By default, Konfuzio relies on Kubernetes <code class="docutils literal notranslate"><span class="pre">Service</span></code> objects of <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">LoadBalancer</span></code> to
expose Konfuzio services using name-based virtual servers configured with <code class="docutils literal notranslate"><span class="pre">Ingress</span></code>
objects. You’ll need to specify a domain which will contain records to resolve the
domain to the appropriate IP.</p>
<p><code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.hosts.domain=example.com</span></code></p>
<div class="section" id="ips">
<h5>IPs<a class="headerlink" href="#ips" title="Permalink to this headline">¶</a></h5>
<p>If you plan to use an automatic DNS registration service,you won’t need any additional
configuration for Konfuzio, but you will need to deploy it to your cluster.</p>
<p>If you plan to manually configure your DNS records they should all point to a static IP.
For example if you choose <code class="docutils literal notranslate"><span class="pre">example.com</span></code> and you have a static IP of <code class="docutils literal notranslate"><span class="pre">10.10.10.10</span></code>, then
<code class="docutils literal notranslate"><span class="pre">konfuzio.example.com</span></code>, <code class="docutils literal notranslate"><span class="pre">registry.example.com</span></code> and <code class="docutils literal notranslate"><span class="pre">minio.example.com</span></code> (if using MinIO) should all resolve to
<code class="docutils literal notranslate"><span class="pre">10.10.10.10</span></code>.</p>
<p><em>Include these options in your Helm install command:</em></p>
<p><code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.hosts.externalIP=10.10.10.</span></code></p>
</div>
</div>
<div class="section" id="persistence">
<h4>Persistence<a class="headerlink" href="#persistence" title="Permalink to this headline">¶</a></h4>
<p>By default the setup will create Volume Claims with the expectation that a dynamic
provisioner will create the underlying Persistent Volumes. If you would like to customize
the storageClass or manually create and assign volumes,please review the <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/">storage
documentation</a>.</p>
<p><strong>Important</strong> : After initial installation, making changes to your storage settings requires manually editing Kubernetes
objects, so it’s best to plan ahead before installing your production instance of Konfuzio to avoid extra storage
migration work.</p>
</div>
<div class="section" id="tls-certificates">
<h4>TLS certificates<a class="headerlink" href="#tls-certificates" title="Permalink to this headline">¶</a></h4>
<p>You should be running Konfuzio using https which requiresTLS certificates. By default, the setup will install and
configure <a class="reference external" href="https://github.com/jetstack/cert-manager">cert-manager</a> to obtain free TLS certificates. If you
have your own wildcard certificate, you already have cert-manager installed, or you have
some other way of obtaining TLS certificates. For the default configuration, you must
specify an email address to register your TLS certificates.</p>
<p><em>Include these options in your Helm install command:</em></p>
<p><code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">certmanager-issuer.email=me&#64;example.com</span></code></p>
</div>
<div class="section" id="postgresql">
<h4>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline">¶</a></h4>
<p>By default this Konfuzio provides an in-cluster PostgreSQL database, for trial purposes
only.</p>
<p><strong>NOTE: This configuration is not recommended for use in production.</strong></p>
<ul class="simple">
<li><p>A single, non-resilient Deployment is used</p></li>
</ul>
<p>You can read more about setting up your production-readydatabase in the PostgreSQL
documentation. As soon you have an external PostgreSQLdatabase ready, Konfuzio can
be configured to use it as shown below.</p>
<p><em>Include these options in your Helm install command:</em></p>
<p><code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">postgresql.install=false</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.psql.host=production.postgress.hostname.local</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.psql.password.secret=kubernetes_secret_name</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.psql.password.key=key_that_contains_postgres_password</span></code></p>
</div>
<div class="section" id="redis">
<h4>Redis<a class="headerlink" href="#redis" title="Permalink to this headline">¶</a></h4>
<p>All the Redis configuration settings are configured automatically.</p>
</div>
<div class="section" id="persistent-volume">
<h4>Persistent Volume<a class="headerlink" href="#persistent-volume" title="Permalink to this headline">¶</a></h4>
<p>Konfuzio relies on object storage for highly-available persistent data in Kubernetes. By default, Konfuzio uses a
<a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">persistent volume</a> within the cluster.</p>
</div>
<div class="section" id="outgoing-email">
<h4>Outgoing email<a class="headerlink" href="#outgoing-email" title="Permalink to this headline">¶</a></h4>
<p>By default outgoing email is disabled. To enable it,provide details for your SMTP server
using the <code class="docutils literal notranslate"><span class="pre">global.smtp</span></code> and <code class="docutils literal notranslate"><span class="pre">global.email</span></code> settings. You can find details for these
settings in the command line options.</p>
<p><code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.smtp.address=smtp.example.com:587</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.smtp.AuthUser=username-here</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.smtp.AuthPass=password-here</span></code></p>
</div>
<div class="section" id="cpu-gpu-and-ram-resource-requirements">
<h4>CPU, GPU and RAM Resource Requirements<a class="headerlink" href="#cpu-gpu-and-ram-resource-requirements" title="Permalink to this headline">¶</a></h4>
<p>The resource requests, and number of replicas for the Konfuzio components in this
setup are set by default to be adequate for a small production deployment. This is
intended to fit in a cluster with at least 16 vCPU with AVX2 support enabled, 32 GB of
RAM and one Nvidia GPU which supports at least CUDA10.1 and CUDNN 7.0. If you are
trying to deploy a non-production instance, you can reduce the defaults in order to fit
into a smaller cluster. Konfuzio can work withoutGPU, however runtime for extraction
and training of medium to large dataset will be significantly slower.</p>
</div>
</div>
<div class="section" id="deploy-using-helm">
<h3>Deploy using Helm<a class="headerlink" href="#deploy-using-helm" title="Permalink to this headline">¶</a></h3>
<p>Once you have all of your configuration options collected, we can get any dependencies
and run Helm. In this example, we’ve named our Helm release <code class="docutils literal notranslate"><span class="pre">konfuzio</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">repo</span> <span class="pre">add</span> <span class="pre">konfuzio</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">repo</span> <span class="pre">update</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">upgrade</span> <span class="pre">--install</span> <span class="pre">konfuzio</span> <span class="pre">konfuzio/server</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--timeout</span> <span class="pre">600s</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.hosts.domain=example.com</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">global.hosts.externalIP=10.10.10.10</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">certmanager-issuer.email=me&#64;example.com</span></code></p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">--version</span> <span class="pre">&lt;installation</span> <span class="pre">version&gt;</span></code> option if you would like to install
a specific version of Konfuzio. This will output the list of resources installed once the
deployment finishes which may take 5-10 minutes.</p>
</div>
<div class="section" id="monitoring-the-deployment">
<h3>Monitoring the Deployment<a class="headerlink" href="#monitoring-the-deployment" title="Permalink to this headline">¶</a></h3>
<p>The status of the deployment can be checked by running <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">status</span> <span class="pre">konfuzio</span></code> which
can also be done while the deployment is taking place if you run the command in
another terminal.</p>
</div>
<div class="section" id="initial-login">
<h3>Initial login<a class="headerlink" href="#initial-login" title="Permalink to this headline">¶</a></h3>
<p>You can access the Konfuzio instance by visiting the domain specified during
installation. If you manually created the secret for initial root password, you can use that
to sign in as <code class="docutils literal notranslate"><span class="pre">root</span></code> user. If not, Konfuzio would’ve automatically created a random
password for <code class="docutils literal notranslate"><span class="pre">root</span></code> user. This can be extracted by the following command (replace
<code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> by name of the release - which is <code class="docutils literal notranslate"><span class="pre">konfuzio</span></code> if you used the command above).</p>
<p><code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">get</span> <span class="pre">secret</span> <span class="pre">&lt;name&gt;-konfuzio-initial-root-password</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">-ojsonpath='{.data.password}'</span> <span class="pre">|</span> <span class="pre">base64</span> <span class="pre">--decode</span> <span class="pre">;</span> <span class="pre">echo</span></code></p>
</div>
</div>
<div class="section" id="upgrade">
<h2>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h2>
<p>Before upgrading your Konfuzio installation, you need to check the <a class="reference external" href="./changelog_app.html">changelog</a>
corresponding to the specific release you want to upgrade to and look for any that might
pertain to the new version.</p>
<p>We also recommend that you take a backup first.</p>
<div class="section" id="steps">
<h3>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h3>
<p>Upgrade Konfuzio following our standard procedure,with the following additions of:</p>
<ol class="arabic simple">
<li><p>Check the change log for the specific version you would like to upgrade to</p></li>
<li><p>Ensure that you have created a <a class="reference external" href="https://www.postgresql.org/docs/11/backup.html">PostgreSQL backup</a> in the previous
step. Without a backup, Konfuzio data might be lost if the upgrade fails.</p></li>
<li><p>Go through deployment section step by step</p></li>
<li><p>Extract your previous <code class="docutils literal notranslate"><span class="pre">--set</span></code> arguments with (see Action1)</p></li>
<li><p>Decide on all the values you need to set</p></li>
<li><p>Perform the upgrade, with all <code class="docutils literal notranslate"><span class="pre">--set</span></code> arguments extracted(see Action 2)</p></li>
<li><p>We will perform the migrations for the Database forPostgreSQL automatically.</p></li>
</ol>
<p><em>Action 1</em></p>
<p><code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">get</span> <span class="pre">values</span> <span class="pre">konfuzio</span> <span class="pre">&gt;</span> <span class="pre">konfuzio.yaml</span></code></p>
<p><em>Action 2</em></p>
<p><code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">upgrade</span> <span class="pre">kofuzio</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--version</span> <span class="pre">&lt;new</span> <span class="pre">version&gt;</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">konfuzio.yaml</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">konfuzio.migrations.enabled=true</span> <span class="pre">\</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">...</span></code></p>
</div>
</div>
<div class="section" id="alternative-deployment-options">
<h2>Alternative deployment options<a class="headerlink" href="#alternative-deployment-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="single-vm-setup">
<h3>Single VM setup<a class="headerlink" href="#single-vm-setup" title="Permalink to this headline">¶</a></h3>
<p>Konfuzio can be configured to run on a single virtual machine, without relying on
Kubernetes. In this scenario, all necessary containers are started manually or with a
container orchestration tool of your choice.</p>
<p>We recommend a virtual machine with a minimum of 12vCPU (incl. AVX2 support) and
64GB of RAM and an installed Docker runtime. A NvidiaGPU is recommended but not
required. In this setup Konfuzio is running in the context of the Docker executor,
therefore there are no strict requirements for theVMs operating systems. However, we
recommend a Linux VM with Debian, Ubuntu, CentOS,or Redhat Linux.</p>
<p>The Konfuzio docker image can be downloaded via “docker pull”. We will provide you
with the credentials. This action requires an internet connection.</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">docker</span> <span class="pre">login</span> <span class="pre">registry.gitlab.com</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">docker</span> <span class="pre">pull</span> <span class="pre">registry.gitlab.com/konfuzio/text-annotation/master:latest</span></code></p>
<p>The internet connection can be turned off once the setup is complete. In case there is
no internet connection available during setup, the container must be transferred with an
alternative method as a file to the virtual machine.</p>
<p>Once you have configured your deployment configuration file, Konfuzio can be started
by passing these settings as environment variables.</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--env-file</span> <span class="pre">&lt;local_path_to</span> <span class="pre">your_deployment_config&gt;</span></code><span class="raw-html-m2r"><br></span>
<code class="docutils literal notranslate"><span class="pre">registry.gitlab.com/konfuzio/text-annotation/master:latest</span></code></p>
<p>We will support you in defining reasonable deploymentsettings for your scenario.</p>
</div>
<div class="section" id="custom-ai-model-training-via-ci-pipelines">
<h3>Custom AI model training via CI pipelines<a class="headerlink" href="#custom-ai-model-training-via-ci-pipelines" title="Permalink to this headline">¶</a></h3>
<p>Konfuzio uses CI pipelines to allow users to run customAI model code securely. In case
the Kubernetes deployment option is not used, we recommend a dedicated virtual
machine to run these pipelines. The selected CI application needs to support Docker
and webhooks. The CI application needs network access to the Konfuzio installation.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="changelog_app.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api.html" class="btn btn-neutral float-left" title="Konfuzio API Video Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Helm und Nagel GmbH.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>